<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assistente Inteligente Cadastro - Softpharma</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #27ae60;
            --warning: #f39c12;
            --bairro-color: #e74c3c;
            --cliente-color: #2ecc71;
            --dependente-color: #9b59b6;
            --convenio-color: #f39c12;
            --consulta-color: #16a085;
            --relatorio-color: #8e44ad;
            --desconto-color: #c0392b;
            --info-color: #3498db;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 1000px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: var(--primary);
            color: white;
            padding: 1.5rem;
            text-align: center;
        }
        
        .header h1 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }
        
        .chat-container {
            height: 600px;
            display: flex;
            flex-direction: column;
        }
        
        .chat-messages {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .message {
            padding: 1rem;
            border-radius: 15px;
            max-width: 85%;
            line-height: 1.4;
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .user-message {
            background: var(--secondary);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }
        
        .bot-message {
            background: var(--light);
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }
        
        .suggested-questions {
            padding: 1rem 1.5rem;
            border-top: 1px solid #eee;
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            background: #f8f9fa;
        }
        
        .suggestion {
            background: white;
            border: 1px solid #dee2e6;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .suggestion.bairro {
            border-left: 4px solid var(--bairro-color);
        }
        
        .suggestion.cliente {
            border-left: 4px solid var(--cliente-color);
        }
        
        .suggestion.dependente {
            border-left: 4px solid var(--dependente-color);
        }
        
        .suggestion.convenio {
            border-left: 4px solid var(--convenio-color);
        }
        
        .suggestion.consulta {
            border-left: 4px solid var(--consulta-color);
        }
        
        .suggestion.relatorio {
            border-left: 4px solid var(--relatorio-color);
        }
        
        .suggestion.desconto {
            border-left: 4px solid var(--desconto-color);
        }
        
        .suggestion:hover {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }
        
        .chat-input {
            display: flex;
            padding: 1rem 1.5rem;
            border-top: 1px solid #eee;
            background: #f8f9fa;
        }
        
        .chat-input input {
            flex: 1;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: 25px;
            outline: none;
            font-size: 0.9rem;
        }
        
        .chat-input button {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 0 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            transition: background 0.3s;
            margin-left: 0.5rem;
        }
        
        .chat-input button:hover {
            background: #2980b9;
        }
        
        .typing-indicator {
            display: none;
            padding: 1rem;
            align-self: flex-start;
        }
        
        .typing-dots {
            display: flex;
            gap: 3px;
        }
        
        .typing-dots span {
            width: 6px;
            height: 6px;
            background: #999;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        
        .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
        .typing-dots span:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }

        .path-highlight {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 0.5rem 1rem;
            margin: 0.5rem 0;
            border-radius: 0 4px 4px 0;
            font-weight: 500;
        }

        .info-box {
            background: #e1f5fe;
            border-left: 4px solid var(--info-color);
            padding: 0.8rem 1rem;
            margin: 0.5rem 0;
            border-radius: 0 4px 4px 0;
            font-size: 0.9rem;
        }

        .warning-box {
            background: #ffecb3;
            border-left: 4px solid var(--warning);
            padding: 0.8rem 1rem;
            margin: 0.5rem 0;
            border-radius: 0 4px 4px 0;
            font-size: 0.9rem;
        }

        .success-box {
            background: #e8f5e8;
            border-left: 4px solid var(--success);
            padding: 0.8rem 1rem;
            margin: 0.5rem 0;
            border-radius: 0 4px 4px 0;
            font-size: 0.9rem;
        }

        .suggested-alternative {
            background: #e8f5e8;
            border-left: 4px solid var(--success);
            padding: 0.8rem 1rem;
            margin: 0.5rem 0;
            border-radius: 0 4px 4px 0;
            font-size: 0.9rem;
        }

        .shortcut-key {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.75rem;
            margin: 0 3px;
            font-family: monospace;
        }

        .commission-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 10px 0;
        }

        .commission-item {
            background: white;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        .module-tag {
            display: inline-block;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            margin-left: 8px;
            font-weight: bold;
        }

        .module-tag.bairro {
            background: var(--bairro-color);
        }

        .module-tag.cliente {
            background: var(--cliente-color);
        }

        .module-tag.dependente {
            background: var(--dependente-color);
        }

        .module-tag.convenio {
            background: var(--convenio-color);
        }

        .module-tag.consulta {
            background: var(--consulta-color);
        }

        .module-tag.relatorio {
            background: var(--relatorio-color);
        }

        .module-tag.desconto {
            background: var(--desconto-color);
        }

        .step-list {
            margin: 10px 0;
            padding-left: 20px;
        }

        .step-list li {
            margin-bottom: 8px;
        }

        .feature-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 10px 0;
        }

        .feature-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid var(--secondary);
        }

        .flow-steps {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            position: relative;
        }

        .flow-steps::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 2px;
            background: #ddd;
            z-index: 1;
        }

        .flow-step {
            background: white;
            border: 2px solid var(--secondary);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            position: relative;
            z-index: 2;
        }

        .flow-step.active {
            background: var(--secondary);
            color: white;
        }

        .flow-label {
            position: absolute;
            top: 35px;
            font-size: 0.7rem;
            text-align: center;
            width: 80px;
            left: -25px;
        }

        .tab-container {
            margin: 10px 0;
        }

        .tab-buttons {
            display: flex;
            border-bottom: 1px solid #ddd;
        }

        .tab-button {
            padding: 8px 15px;
            background: #f8f9fa;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-button.active {
            background: white;
            border-bottom: 3px solid var(--secondary);
            font-weight: bold;
        }

        .tab-content {
            padding: 15px;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        .data-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 10px 0;
        }

        .data-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid var(--info-color);
        }

        @media (max-width: 768px) {
            .commission-grid, .feature-list, .data-grid {
                grid-template-columns: 1fr;
            }
            
            .flow-steps {
                flex-wrap: wrap;
                justify-content: center;
                gap: 20px;
            }
            
            .flow-steps::before {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üíä Assistente Inteligente Cadastro - Softpharma</h1>
            <p>Guia completo para cadastro de clientes - Integra√ß√£o de todos os m√≥dulos</p>
        </div>
        
        <div class="chat-container">
            <div class="chat-messages" id="chat-messages">
                <div class="message bot-message">
                    Ol√°! Sou seu assistente especializado em <strong>Cadastro Completo de Clientes</strong> no Softpharma. 
                    Vou gui√°-lo atrav√©s de todo o processo passo a passo! üöÄ
                </div>
            </div>
            
            <div class="suggested-questions">
                <div class="suggestion cliente" data-question="como cadastrar um cliente">Cadastrar Cliente</div>
                <div class="suggestion cliente" data-question="dados basicos">Dados B√°sicos</div>
                <div class="suggestion convenio" data-question="vincular convenio">Vincular Conv√™nio</div>
                <div class="suggestion dependente" data-question="cadastrar dependente">Dependentes</div>
                <div class="suggestion desconto" data-question="configurar descontos">Descontos</div>
            </div>
            
            <div class="typing-indicator" id="typing-indicator">
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            
            <div class="chat-input">
                <input type="text" id="user-input" placeholder="Ex: como cadastrar um cliente...">
                <button id="send-btn">Enviar</button>
            </div>
        </div>
    </div>

    <script>
        // Base de conhecimento completa integrando todos os manuais
        const knowledgeBase = {
            "cadastro_completo": {
                targetWords: ["cadastrar cliente", "cliente completo", "novo cliente", "cadastro completo", "todos dados cliente", "como cadastrar", "passo a passo cliente"],
                answer: `<strong>üë§ CADASTRO COMPLETO DE CLIENTE <span class="module-tag cliente">GUIA COMPLETO</span></strong><br><br>
                
                <div class="path-highlight">Menu > Cadastros > Clientes > Novo</div><br>
                
                <div class="flow-steps">
                    <div class="flow-step active">1<div class="flow-label">Dados B√°sicos</div></div>
                    <div class="flow-step">2<div class="flow-label">Info. Adicionais</div></div>
                    <div class="flow-step">3<div class="flow-label">Dependentes</div></div>
                    <div class="flow-step">4<div class="flow-label">Conv√™nios</div></div>
                    <div class="flow-step">5<div class="flow-label">Descontos</div></div>
                </div>
                
                <div class="tab-container">
                    <div class="tab-buttons">
                        <button class="tab-button active" onclick="openTab(event, 'tab1')">1. Dados B√°sicos</button>
                        <button class="tab-button" onclick="openTab(event, 'tab2')">2. Info. Adicionais</button>
                        <button class="tab-button" onclick="openTab(event, 'tab3')">3. Dependentes</button>
                        <button class="tab-button" onclick="openTab(event, 'tab4')">4. Conv√™nios</button>
                        <button class="tab-button" onclick="openTab(event, 'tab5')">5. Descontos</button>
                    </div>
                    
                    <div class="tab-content">
                        <div id="tab1" class="tab-pane active">
                            <strong>üìã DADOS B√ÅSICOS (Obrigat√≥rios)</strong><br><br>
                            
                            <div class="data-grid">
                                <div class="data-item">
                                    <strong>Identifica√ß√£o</strong><br>
                                    ‚Ä¢ C√≥digo (autom√°tico)<br>
                                    ‚Ä¢ Nome completo<br>
                                    ‚Ä¢ CPF/CNPJ (se exigido)
                                </div>
                                <div class="data-item">
                                    <strong>Endere√ßo</strong><br>
                                    ‚Ä¢ CEP (autocompleta)<br>
                                    ‚Ä¢ Endere√ßo completo<br>
                                    ‚Ä¢ N√∫mero, complemento
                                </div>
                                <div class="data-item">
                                    <strong>Contato</strong><br>
                                    ‚Ä¢ Telefone/Celular<br>
                                    ‚Ä¢ E-mails (at√© 5)<br>
                                    ‚Ä¢ LGPD assinado
                                </div>
                                <div class="data-item">
                                    <strong>Documentos</strong><br>
                                    ‚Ä¢ Tipo documento<br>
                                    ‚Ä¢ √ìrg√£o expedidor<br>
                                    ‚Ä¢ N√∫mero e UF
                                </div>
                            </div>
                            
                            <div class="warning-box">
                                <strong>Importante:</strong> Dados de endere√ßo devem estar corretos para malas diretas, correspond√™ncias e relat√≥rios fiscais (Nota Fiscal Paulista, SPED EFD).
                            </div>
                        </div>
                        
                        <div id="tab2" class="tab-pane">
                            <strong>üìä INFORMA√á√ïES ADICIONAIS</strong><br><br>
                            
                            <div class="data-grid">
                                <div class="data-item">
                                    <strong>Dados Pessoais</strong><br>
                                    ‚Ä¢ Estado civil<br>
                                    ‚Ä¢ Nome c√¥njuge<br>
                                    ‚Ä¢ Nome dos pais
                                </div>
                                <div class="data-item">
                                    <strong>Situa√ß√£o Financeira</strong><br>
                                    ‚Ä¢ Renda familiar<br>
                                    ‚Ä¢ Tempo resid√™ncia<br>
                                    ‚Ä¢ Casa pr√≥pria
                                </div>
                                <div class="data-item">
                                    <strong>Controles</strong><br>
                                    ‚Ä¢ N√£o ligar P√≥s-Vendas<br>
                                    ‚Ä¢ SPC (prote√ß√£o cr√©dito)<br>
                                    ‚Ä¢ Pontua√ß√£o fidelidade
                                </div>
                                <div class="data-item">
                                    <strong>Fiscal</strong><br>
                                    ‚Ä¢ Tipo contribuinte<br>
                                    ‚Ä¢ Inscri√ß√£o Estadual<br>
                                    ‚Ä¢ SUFRAMA
                                </div>
                            </div>
                            
                            <div class="info-box">
                                <strong>Senha/Biometria:</strong> Gere senha padr√£o (6 d√≠gitos) ou cadastre at√© 5 biometrias. Senha vis√≠vel na Ficha do Cliente.
                            </div>
                        </div>
                        
                        <div id="tab3" class="tab-pane">
                            <strong>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ DEPENDENTES</strong><br><br>
                            
                            <div class="data-grid">
                                <div class="data-item">
                                    <strong>Dados do Dependente</strong><br>
                                    ‚Ä¢ Nome completo<br>
                                    ‚Ä¢ Grau parentesco<br>
                                    ‚Ä¢ Telefone contato
                                </div>
                                <div class="data-item">
                                    <strong>Informa√ß√µes</strong><br>
                                    ‚Ä¢ Data nascimento<br>
                                    ‚Ä¢ Situa√ß√£o (ativo/inativo)<br>
                                    ‚Ä¢ Senha pr√≥pria
                                </div>
                            </div>
                            
                            <div class="warning-box">
                                <strong>Aten√ß√£o:</strong> Ao inativar dependente, sistema remove automaticamente autoriza√ß√µes em conv√™nios vinculados.
                            </div>
                            
                            <div class="info-box">
                                <strong>Controle de Acesso:</strong> Dependentes podem ter senha pr√≥pria (6 d√≠gitos) ou biometria cadastrada (at√© 5 digitais).
                            </div>
                        </div>
                        
                        <div id="tab4" class="tab-pane">
                            <strong>üìã VINCULAR CONV√äNIOS</strong><br><br>
                            
                            <strong>Passo a passo:</strong>
                            <ol class="step-list">
                                <li>Clique em <strong>"Novo"</strong> na guia Conv√™nios</li>
                                <li>Informe c√≥digo do conv√™nio (F2 para consultar)</li>
                                <li>Preencha <strong>matr√≠cula</strong> (ou deixe autom√°tica)</li>
                                <li>Configure <strong>situa√ß√£o</strong> do v√≠nculo</li>
                                <li>Defina <strong>limite de cr√©dito</strong></li>
                                <li>Configure fechamento/vencimento</li>
                                <li>Clique em <strong>"Aplicar"</strong></li>
                            </ol>
                            
                            <div class="warning-box">
                                <strong>Obrigat√≥rio:</strong> Todo cliente precisa ter pelo menos 1 conv√™nio vinculado!
                            </div>
                            
                            <div class="info-box">
                                <strong>Configura√ß√µes importantes:</strong> Car√™ncia (Particular/VIP), Cobrar juros/multa, Bloquear fidelidade, Cart√£o entregue.
                            </div>
                        </div>
                        
                        <div id="tab5" class="tab-pane">
                            <strong>üí∞ CONFIGURAR DESCONTOS</strong><br><br>
                            
                            <div class="feature-list">
                                <div class="feature-item">
                                    <strong>Desconto Geral</strong><br>
                                    Por modalidade de pagamento:<br>
                                    ‚Ä¢ √Ä vista<br>
                                    ‚Ä¢ A prazo<br>
                                    ‚Ä¢ Cheque<br>
                                    ‚Ä¢ Cart√£o
                                </div>
                                <div class="feature-item">
                                    <strong>Descontos Espec√≠ficos</strong><br>
                                    Por categoria:<br>
                                    ‚Ä¢ Grupo principal<br>
                                    ‚Ä¢ Tipo produto<br>
                                    ‚Ä¢ Laborat√≥rio<br>
                                    ‚Ä¢ Produto espec√≠fico
                                </div>
                            </div>
                            
                            <strong>Tipos de Desconto:</strong>
                            <ul class="step-list">
                                <li><strong>Normal:</strong> Percentual fixo por modalidade</li>
                                <li><strong>Por Faixa:</strong> Por intervalo de valores da compra</li>
                                <li><strong>Por Condi√ß√£o:</strong> Por condi√ß√£o de pagamento espec√≠fica</li>
                            </ul>
                            
                            <div class="info-box">
                                <strong>Hierarquia de Descontos:</strong> 1¬∫ Produto ‚Üí 2¬∫ Laborat√≥rio ‚Üí 3¬∫ Tipo ‚Üí 4¬∫ Grupo Principal
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="success-box">
                    <strong>üéØ FLUXO RECOMENDADO:</strong> Siga a ordem das abas para um cadastro completo e eficiente!
                </div>`
            },

            "dados_basicos": {
                targetWords: ["dados b√°sicos", "dados basicos", "endere√ßo", "endereco", "telefone", "email", "e-mail", "cpf", "cnpj", "lgpd", "informa√ß√µes b√°sicas"],
                answer: `<strong>üìã DADOS B√ÅSICOS DO CLIENTE <span class="module-tag cliente">M√ìDULO CLIENTES</span></strong><br><br>
                
                <div class="path-highlight">Menu > Cadastros > Clientes > [Cliente] > Dados B√°sicos</div><br>
                
                <div class="data-grid">
                    <div class="data-item">
                        <strong>Identifica√ß√£o</strong><br>
                        ‚Ä¢ C√≥digo: (Filial √ó 10.000) + Sequ√™ncia<br>
                        ‚Ä¢ Nome completo<br>
                        ‚Ä¢ CPF/CNPJ (se exigido pelo conv√™nio)
                    </div>
                    <div class="data-item">
                        <strong>Endere√ßo</strong><br>
                        ‚Ä¢ CEP (consulta autom√°tica)<br>
                        ‚Ä¢ Endere√ßo, n√∫mero<br>
                        ‚Ä¢ Complemento, pr√≥ximo<br>
                        ‚Ä¢ Cidade, bairro, UF
                    </div>
                    <div class="data-item">
                        <strong>Contatos</strong><br>
                        ‚Ä¢ Telefone fixo<br>
                        ‚Ä¢ Celular<br>
                        ‚Ä¢ E-mails (at√© 5)<br>
                        ‚Ä¢ LGPD assinado
                    </div>
                    <div class="data-item">
                        <strong>Documentos</strong><br>
                        ‚Ä¢ Tipo documento<br>
                        ‚Ä¢ √ìrg√£o expedi√ß√£o<br>
                        ‚Ä¢ N√∫mero documento<br>
                        ‚Ä¢ UF emiss√£o
                    </div>
                </div>
                
                <div class="info-box">
                    <strong>Funcionalidades:</strong><br>
                    ‚Ä¢ CEP autocompleta endere√ßo<br>
                    ‚Ä¢ E-mails s√£o links clic√°veis<br>
                    ‚Ä¢ NF-e/NFC-e enviadas para e-mail cadastrado<br>
                    ‚Ä¢ Cadastro de bairro solicitado se n√£o existir
                </div>
                
                <div class="warning-box">
                    <strong>Importante:</strong> Dados de endere√ßo corretos s√£o essenciais para malas diretas, correspond√™ncias e relat√≥rios fiscais (Nota Fiscal Paulista, SPED EFD).
                </div>`
            },

            "convenios": {
                targetWords: ["conv√™nio", "convenio", "conv√™nios", "convenios", "vincular", "matr√≠cula", "matricula", "limite cr√©dito", "limite credito", "vincular convenio", "como vincular"],
                answer: `<strong>üìã VINCULAR CONV√äNIOS <span class="module-tag convenio">M√ìDULO CONV√äNIOS</span></strong><br><br>
                
                <div class="path-highlight">Menu > Cadastros > Clientes > [Cliente] > Conv√™nios</div><br>
                
                <strong>Passo a passo para vincular conv√™nio:</strong>
                <ol class="step-list">
                    <li>Na guia <strong>Conv√™nios</strong>, clique em <strong>"Novo"</strong></li>
                    <li>Informe o c√≥digo do conv√™nio ou use <span class="shortcut-key">F2</span> para consultar</li>
                    <li>Preencha a <strong>matr√≠cula</strong>:
                        <ul>
                            <li>Manual: n√∫mero de telefone ou identifica√ß√£o desejada</li>
                            <li>Autom√°tica: c√≥digo cliente + c√≥digo conv√™nio</li>
                        </ul>
                    </li>
                    <li>Configure a <strong>situa√ß√£o</strong> do v√≠nculo (Ativo/Bloqueado/Suspenso/Inativo)</li>
                    <li>Defina o <strong>limite de cr√©dito</strong> mensal (opcional)</li>
                    <li>Configure <strong>fechamento/vencimento</strong>:
                        <ul>
                            <li>Fechamento: data padr√£o do conv√™nio</li>
                            <li>Dias prazo: vencimento em dias ap√≥s compra</li>
                        </ul>
                    </li>
                    <li>Clique em <strong>"Aplicar"</strong> para salvar</li>
                </ol>
                
                <div class="warning-box">
                    <strong>OBRIGAT√ìRIO:</strong> Cliente deve ter pelo menos 1 conv√™nio vinculado! Sem conv√™nio, o cadastro √© abortado.
                </div>
                
                <div class="info-box">
                    <strong>Configura√ß√µes importantes na aba Geral:</strong><br>
                    ‚Ä¢ <strong>Car√™ncia:</strong> Para conv√™nios Particular, VIP I e VIP II<br>
                    ‚Ä¢ <strong>Cobrar juros/multa:</strong> Por atraso ou na venda<br>
                    ‚Ä¢ <strong>Bloquear fidelidade:</strong> N√£o gerar pontos para cliente espec√≠fico<br>
                    ‚Ä¢ <strong>Cart√£o entregue:</strong> Marcar quando cart√£o foi entregue
                </div>`
            },

            "dependentes": {
                targetWords: ["dependente", "dependentes", "familia", "familiar", "parente", "filho", "filha", "parentesco", "cadastrar dependente", "como cadastrar dependente"],
                answer: `<strong>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ CADASTRO DE DEPENDENTES <span class="module-tag dependente">M√ìDULO DEPENDENTES</span></strong><br><br>
                
                <div class="path-highlight">Menu > Cadastros > Clientes > [Cliente] > Dependentes</div><br>
                
                <strong>Passo a passo para cadastrar dependente:</strong>
                <ol class="step-list">
                    <li>Na guia <strong>Dependentes</strong>, clique para adicionar novo</li>
                    <li>Preencha os dados obrigat√≥rios:
                        <ul>
                            <li><strong>Nome completo</strong> do dependente</li>
                            <li><strong>Grau de parentesco</strong></li>
                            <li><strong>Telefone de contato</strong></li>
                            <li><strong>Data de nascimento</strong></li>
                            <li><strong>Situa√ß√£o</strong> (Ativo/Inativo)</li>
                        </ul>
                    </li>
                    <li>Para controle de acesso:
                        <ul>
                            <li><strong>Gerar Senha Padr√£o:</strong> Sistema cria senha de 6 d√≠gitos</li>
                            <li><strong>Cadastrar Biometria:</strong> At√© 5 digitais</li>
                        </ul>
                    </li>
                    <li>Pressione <span class="shortcut-key">Enter</span> para salvar</li>
                </ol>
                
                <div class="warning-box">
                    <strong>ATEN√á√ÉO:</strong> Ao inativar dependente, o sistema exibe mensagem: "O dependente est√° autorizado no conv√™nio, ao inativar o dependente o v√≠nculo ser√° desfeito. Deseja Continuar?" Se [Sim], remove automaticamente as autoriza√ß√µes.
                </div>
                
                <div class="info-box">
                    <strong>Autoriza√ß√£o em Conv√™nios:</strong><br>
                    ‚Ä¢ Na guia Conv√™nios > Aba Dependentes<br>
                    ‚Ä¢ Marque os dependentes autorizados a comprar<br>
                    ‚Ä¢ Configure limite individual para cada dependente<br>
                    ‚Ä¢ Informe n√∫mero do cart√£o fidelidade do dependente
                </div>`
            },

            "descontos": {
                targetWords: ["desconto", "descontos", "liberar desconto", "retirar desconto", "bloqueio", "bloqueios", "percentual", "configurar descontos", "como configurar desconto"],
                answer: `<strong>üí∞ CONFIGURAR DESCONTOS E BLOQUEIOS <span class="module-tag desconto">M√ìDULO DESCONTOS</span></strong><br><br>
                
                <div class="path-highlight">Menu > Cadastros > Clientes > [Cliente] > Conv√™nios > Descontos e Bloqueios</div><br>
                
                <strong>DESCONTO GERAL NAS VENDAS:</strong><br>
                Configure percentuais por modalidade de pagamento:<br>
                ‚Ä¢ √Ä vista ‚Ä¢ A prazo ‚Ä¢ Cheque ‚Ä¢ Cart√£o<br><br>
                
                <strong>DESCONTOS ESPEC√çFICOS - Passo a passo:</strong>
                <ol class="step-list">
                    <li>Selecione em <strong>"Descontos na Venda"</strong>:
                        <ul>
                            <li>Liberar ou bloquear desconto por:</li>
                            <li>Grupo principal, Tipo produto, Laborat√≥rio ou Produto</li>
                        </ul>
                    </li>
                    <li>Escolha o <strong>"Tipo de Desconto"</strong>:
                        <ul>
                            <li><strong>Normal:</strong> Percentual fixo por modalidade</li>
                            <li><strong>Por Faixa:</strong> Por intervalo de valores (ex: R$0,01-15,00 = 5%)</li>
                            <li><strong>Por Condi√ß√£o:</strong> Por condi√ß√£o de pagamento espec√≠fica</li>
                        </ul>
                    </li>
                    <li>Preencha os percentuais ou valores</li>
                    <li>As regras aparecer√£o no quadro ao lado</li>
                    <li>Para excluir: <span class="shortcut-key">DELETE</span> sobre a regra</li>
                    <li>Para alterar: Duplo clique na regra</li>
                </ol>
                
                <div class="info-box">
                    <strong>HIERARQUIA DE DESCONTOS (ordem de aplica√ß√£o):</strong><br>
                    1¬∫ <strong>Produto</strong> ‚Üí 2¬∫ <strong>Laborat√≥rio</strong> ‚Üí 3¬∫ <strong>Tipo</strong> ‚Üí 4¬∫ <strong>Grupo Principal</strong>
                </div>
                
                <div class="warning-box">
                    <strong>OBSERVA√á√ïES:</strong><br>
                    ‚Ä¢ Desconto por faixa N√ÉO est√° dispon√≠vel para "Liberar desc. Produto"<br>
                    ‚Ä¢ Se marcar modalidade sem informar valor, aplica 0,00% (bloqueia desconto)<br>
                    ‚Ä¢ Desconto do Cadastro de Clientes √© validado ANTES do desconto do Conv√™nio
                </div>`
            },

            "informacoes_adicionais": {
                targetWords: ["informa√ß√µes adicionais", "informacoes adicionais", "dados extras", "fiscal", "spc", "p√≥s venda", "fidelidade"],
                answer: `<strong>üìä INFORMA√á√ïES ADICIONAIS <span class="module-tag cliente">M√ìDULO CLIENTES</span></strong><br><br>
                
                <div class="path-highlight">Menu > Cadastros > Clientes > [Cliente] > Informa√ß√µes Adicionais</div><br>
                
                <div class="data-grid">
                    <div class="data-item">
                        <strong>Dados Pessoais</strong><br>
                        ‚Ä¢ Estado civil<br>
                        ‚Ä¢ Nome e nascimento c√¥njuge<br>
                        ‚Ä¢ Nome dos pais
                    </div>
                    <div class="data-item">
                        <strong>Situa√ß√£o Financeira</strong><br>
                        ‚Ä¢ Renda familiar<br>
                        ‚Ä¢ Tempo de resid√™ncia<br>
                        ‚Ä¢ Casa pr√≥pria
                    </div>
                    <div class="data-item">
                        <strong>Controles</strong><br>
                        ‚Ä¢ N√£o ligar em P√≥s Vendas<br>
                        ‚Ä¢ SPC (prote√ß√£o cr√©dito)<br>
                        ‚Ä¢ Pontua√ß√£o fidelidade<br>
                        ‚Ä¢ Benef√≠cio aposentado
                    </div>
                    <div class="data-item">
                        <strong>Fiscal</strong><br>
                        ‚Ä¢ Tipo contribuinte<br>
                        ‚Ä¢ Inscri√ß√£o Estadual<br>
                        ‚Ä¢ SUFRAMA<br>
                        ‚Ä¢ Conta cont√°bil
                    </div>
                </div>
                
                <div class="info-box">
                    <strong>Controle por Senha/Biometria:</strong><br>
                    ‚Ä¢ <strong>Gerar Senha Padr√£o:</strong> Sistema cria senha de 6 d√≠gitos, vis√≠vel apenas na Ficha do Cliente<br>
                    ‚Ä¢ <strong>Alterar Biometria/Senha:</strong> Cliente digita senha atual e nova, pode cadastrar at√© 5 biometrias
                </div>
                
                <div class="warning-box">
                    <strong>SPC:</strong> Ao marcar, sistema exibe mensagem durante venda, permitindo decidir se vende √† prazo ou somente √† vista.
                </div>`
            }
        };

        // Elementos do DOM
        const chatMessages = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const typingIndicator = document.getElementById('typing-indicator');
        const suggestions = document.querySelectorAll('.suggestion');

        // Fun√ß√£o para normalizar texto
        function normalizeText(text) {
            return text
                .toLowerCase()
                .normalize('NFD')
                .replace(/[\u0300-\u036f]/g, '')
                .replace(/[^\w\s]/gi, ' ');
        }

        // Sistema de correspond√™ncia inteligente
        function findBestMatch(question) {
            const normalizedQuestion = normalizeText(question);
            console.log('Pergunta normalizada:', normalizedQuestion);
            
            // Contagem de correspond√™ncias por m√≥dulo
            const matchCounts = {};
            
            // Verifica correspond√™ncias para cada m√≥dulo
            for (const [module, data] of Object.entries(knowledgeBase)) {
                matchCounts[module] = 0;
                
                for (const targetWord of data.targetWords) {
                    if (normalizedQuestion.includes(targetWord)) {
                        matchCounts[module]++;
                        console.log(`Encontrado: "${targetWord}" no m√≥dulo ${module}`);
                    }
                }
            }
            
            // Encontra o m√≥dulo com mais correspond√™ncias
            let bestMatch = null;
            let maxMatches = 0;
            
            for (const [module, count] of Object.entries(matchCounts)) {
                if (count > maxMatches) {
                    maxMatches = count;
                    bestMatch = module;
                }
            }
            
            console.log('Melhor correspond√™ncia:', bestMatch, 'com', maxMatches, 'matches');
            
            // Retorna a resposta do m√≥dulo com mais correspond√™ncias
            if (bestMatch && maxMatches > 0) {
                return knowledgeBase[bestMatch].answer;
            }
            
            // Se n√£o encontrou correspond√™ncia espec√≠fica
            return getDefaultResponse();
        }

        // Resposta padr√£o quando n√£o encontra correspond√™ncia
        function getDefaultResponse() {
            return `ü§î <strong>N√£o entendi completamente sua pergunta!</strong><br><br>
                <div class="suggested-alternative">
                <strong>Estou aqui para ajudar com o cadastro completo de clientes. Tente uma dessas op√ß√µes:</strong><br><br>
                ‚Ä¢ "<strong style="cursor:pointer; color: var(--cliente-color);" onclick="askQuestion('como cadastrar um cliente')">como cadastrar um cliente</strong>" - Guia passo a passo completo<br>
                ‚Ä¢ "<strong style="cursor:pointer; color: var(--cliente-color);" onclick="askQuestion('dados basicos')">dados b√°sicos</strong>" - Informa√ß√µes obrigat√≥rias<br>
                ‚Ä¢ "<strong style="cursor:pointer; color: var(--convenio-color);" onclick="askQuestion('vincular convenio')">vincular conv√™nio</strong>" - Vincular plano<br>
                ‚Ä¢ "<strong style="cursor:pointer; color: var(--dependente-color);" onclick="askQuestion('cadastrar dependente')">dependentes</strong>" - Familiares autorizados<br>
                ‚Ä¢ "<strong style="cursor:pointer; color: var(--desconto-color);" onclick="askQuestion('configurar descontos')">descontos</strong>" - Configurar benef√≠cios<br>
                <br><em>Ou use as sugest√µes de perguntas acima!</em>
                </div>`;
        }

        // Fun√ß√£o para abrir abas
        function openTab(evt, tabName) {
            const tabcontent = document.querySelectorAll('.tab-pane');
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove('active');
            }
            
            const tablinks = document.querySelectorAll('.tab-button');
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove('active');
            }
            
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
        }

        // Fun√ß√£o para adicionar mensagem no chat
        function addMessage(message, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message');
            messageDiv.classList.add(isUser ? 'user-message' : 'bot-message');
            messageDiv.innerHTML = message;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Fun√ß√£o para mostrar indicador de digita√ß√£o
        function showTyping() {
            typingIndicator.style.display = 'block';
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Fun√ß√£o para esconder indicador de digita√ß√£o
        function hideTyping() {
            typingIndicator.style.display = 'none';
        }

        // Fun√ß√£o global para fazer perguntas
        function askQuestion(question) {
            userInput.value = question;
            sendMessage();
        }

        // Fun√ß√£o para enviar mensagem
        function sendMessage() {
            const question = userInput.value.trim();
            if (question === '') return;
            
            addMessage(question, true);
            userInput.value = '';
            
            showTyping();
            
            setTimeout(() => {
                hideTyping();
                const answer = findBestMatch(question);
                addMessage(answer);
            }, 800);
        }

        // Event listeners
        sendBtn.addEventListener('click', sendMessage);
        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Sugest√µes de perguntas
        suggestions.forEach(suggestion => {
            suggestion.addEventListener('click', () => {
                const question = suggestion.getAttribute('data-question');
                askQuestion(question);
            });
        });

        // Mensagem de boas-vindas
        setTimeout(() => {
            addMessage(`<strong>üéØ ASSISTENTE DE CADASTRO COMPLETO - SOFT PHARMA</strong><br><br>
            <strong>Agora com respostas espec√≠ficas para cada tipo de pergunta!</strong><br><br>
            Experimente perguntar:<br>
            ‚Ä¢ "<strong>Como cadastrar um cliente</strong>" - Guia completo<br>
            ‚Ä¢ "<strong>Vincular conv√™nio</strong>" - Passo a passo espec√≠fico<br>
            ‚Ä¢ "<strong>Cadastrar dependente</strong>" - Instru√ß√µes detalhadas<br>
            ‚Ä¢ "<strong>Configurar descontos</strong>" - Tutorial completo<br><br>
            <em>Ou clique nas sugest√µes acima! üòä</em>`);
        }, 1000);

        // Tornar a fun√ß√£o global
        window.askQuestion = askQuestion;
        window.openTab = openTab;
    </script>
</body>
</html>
